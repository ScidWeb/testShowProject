async function startServices(){let e,s=0,t=await async function(){let e;try{e=await fetch("https://winia.ru/ajax/load-services/")}catch(e){new Error("Request failed! "+e)}if(!e.ok)throw new Error(`${e.status}: ${e.statusText}`);return e.json()}(),i=await t;function n(){if(e){const s=$(".services").find(".js-toggle-map");e.setCenter([event.target.dataset.latitude,event.target.dataset.longitude],9),s.trigger("click")}}function l(e=!1){const t=$(".services-list");e&&(t.empty(),s=0),i.forEach((e,i)=>{if(i>=s&&i<=s+10){let s="",i="",l="";e.telephones.length&&e.telephones.forEach((t,i)=>{i===e.telephones.length-1?s+=`<a href="tel:${t}" class="services-list-item-cell__link">${t}</a>`:s+=`<a href="tel:${t}" class="services-list-item-cell__link">${t}, </a>`}),e.userFieldsData&&e.userFieldsData.forEach(e=>{e&&(i+=`\n        <div class="services-list-item-cell__row">\n          <span class="services-list-item-cell__text">${e}</span>\n        </div>`)}),e.email&&(l+=`\n      <div class="services-list-item-cell__row">\n        <a href="mailto:${e.email}" class="services-list-item-cell__link">${e.email}</a>\n      </div>\n      `);const a=$(`\n          <div class="services-list__item">\n            <div class="services-list-item">\n              <div class="services-list-item__information">\n                <h2 class="services-list-item__title">${e.title}</h2>\n                <div class="services-list-item__cell">\n                  <div class="services-list-item-cell">\n                    <h3 class="services-list-item-cell__title">Адрес</h3>\n                    <div class="services-list-item-cell__content">\n                      <div class="services-list-item-cell__row">\n                        <span class="services-list-item-cell__text">${e.country}, </span>\n                        <span class="services-list-item-cell__text">${e.region}</span>\n                      </div>\n                      <div class="services-list-item-cell__row">\n                        <span class="services-list-item-cell__text">${e.city}, </span>\n                      </div>\n                      <div class="services-list-item-cell__row">\n                        <span class="services-list-item-cell__text">${e.address}, </span>\n                      </div>\n                      <div class="services-list-item-cell__row">\n                        <span class="services-list-item-cell__text">${e.postcode}</span>\n                      </div>\n                    </div>\n                  </div>\n  \n                  <div class="services-list-item-cell">\n                    <h3 class="services-list-item-cell__title">Контакты</h3>\n                    <div class="services-list-item-cell__content">\n                      <div class="services-list-item-cell__row">\n                        ${s}\n                      </div>\n                        ${l}\n                    </div>\n                  </div>\n  \n                  <div class="services-list-item-cell">\n                    <h3 class="services-list-item-cell__title">Режим работы</h3>\n                    <div class="services-list-item-cell__content">\n                      ${i}\n                    </div>\n                  </div>\n                </div>\n              </div>\n  \n              <div class="services-list-item__buttons">\n                <div class="services-list-item__button">\n                  <button class="button button_services-item js-move-map" data-longitude="${e.longitude}" data-latitude="${e.latitude}" >Показать на карте</button>\n                </div>\n                <div class="services-list-item__button">\n                <a href="https://yandex.ru/maps/?pt=${e.longitude},${e.latitude}&z=9&l=map" class="services-list__link-button">Проложить маршрут</a>\n                </div>\n              </div>\n            </div>\n          </div>\n        `);a.find(".js-move-map").on("click",n),t.append(a)}}),e||(s+=10)}$(document).ready((function(){const e=$(".services"),s=e.find(".js-toggle-map"),t=e.find(".js-toggle-list"),i=e.find(".js-show-map"),n=e.find(".js-show-list");s.on("click",(function(e){e.preventDefault(),t.removeClass("button_services_active"),s.addClass("button_services_active"),n.hide(),i.show()})),t.on("click",(function(e){e.preventDefault(),s.removeClass("button_services_active"),t.addClass("button_services_active"),i.hide(),n.show()}))})),ymaps.ready((async function(){e=new ymaps.Map("map",{center:[55.751574,37.573856],zoom:9,controls:["zoomControl"]},{searchControlProvider:"yandex#search"}),t.forEach(s=>{let t="",i="";s.telephones.length&&s.telephones.forEach((e,i)=>{i===s.telephones.length-1?t+=`<a href="tel:${e}" class="services-map__link">${e}</a>`:t+=`<a href="tel:${e}" class="services-map__link">${e}, </a>`}),s.userFieldsData&&s.userFieldsData.forEach(e=>{i+=`\n            <span class="services-map__text">${e}</span>\n          `});const n=s.hint,l=`<div class="services-map__title">${s.title}</div>`,a=`\n          <div class="services-map__information">\n              <div class="services-map__row">\n                <span class="services-map__text">${s.city}, </span>\n                <span class="services-map__text">${s.address}</span>\n              </div>\n              <div class="services-map__row">\n                ${t}\n              </div>\n              <div class="services-map__row">\n                ${i}\n              </div>\n              </div>\n              \n              <div class="services-map__button">\n                <a href="https://yandex.ru/maps/?pt=${s.longitude},${s.latitude}&z=9&l=map" class="services-map__link-button">Проложить маршрут</a>\n              </div>`,c=new ymaps.Placemark([s.latitude,s.longitude],{balloonContentHeader:l,balloonContentBody:a,hintContent:n},{iconLayout:"default#image",iconImageHref:"assets/img/services/services_1.svg",iconImageSize:[27,33],iconImageOffset:[-13,-33],balloonPanelMaxMapArea:220400});e.geoObjects.add(c)})})),$(window).on("scroll",()=>{$(window).innerHeight()+$(window).scrollTop()>=$("body").height()&&l()}),l(),function(){const e=$(".js-header-autocomplete");t.forEach(s=>{e.append(`<option value="${s.city}">${s.city}</option>`)})}(),$(".js-header-autocomplete").selectize({onChange:function(s){s?(i=t.filter(e=>e.city===s),e.setCenter([i[0].latitude,i[0].longitude],9),l(!0)):(i=t,l())}})}startServices();